close all
clear
clc

Displacement = [0.0, 0.05, 0.1, 0.15000000000000002, 0.2, 0.25, 0.30000000000000004, 0.35000000000000003, 0.4, 0.45];


v0 = [1.0000000000000624, 1.0027954990621906, 1.005129069896842, 1.0070810131111927, 1.008714616386691, 1.0100753450522149, 1.0111901525649674, 1.0120669842461514, 1.0127705536802185, 1.013349064445531];

v1 = [1.0000000000000624, 1.002646772547642, 1.0048550222762336, 1.006700623203991, 1.0082434380561505, 1.0095264502019117, 1.0105751650506147, 1.0113973214488872, 1.0120548703214458, 1.012591915966411];

v2 = [1.0000000000000624, 1.0025132822987695, 1.004609200989912, 1.0063597364262216, 1.007821720385873, 1.0090359424491941, 1.0100266255633834, 1.0108012849276375, 1.011419391958282, 1.011921634928179];

v3 = [1.0000000000000624, 1.00239279672771, 1.0043874433693374, 1.0060524604463157, 1.0074419717466645, 1.0085948062761467, 1.0095340349709503, 1.0102669364668542, 1.0108507328316714, 1.011323195386085];

v4 = [1.0000000000000624, 1.002283500146746, 1.0041863693763646, 1.005774027486203, 1.007098159862607, 1.0081958285123038, 1.00908905973577, 1.0097848903687288, 1.0103384818921404, 1.0107850839179064];

v5 = [1.0000000000000624, 1.002183900124522, 1.0040032053402164, 1.0055205362072663, 1.0067853680344212, 1.007833159508854, 1.0086849832497358, 1.0093476377875659, 1.0098743753768562, 1.0102982458358962];

v6 = [1.0000000000000624, 1.0020927585675858, 1.0038356534443964, 1.0052887621543785, 1.006499545603855, 1.0075019995175756, 1.0083163213678337, 1.008949074368195, 1.0094517453267209, 1.009855433502206];

v7 = [1.0000000000000624, 1.0020090397235788, 1.0036817936328017, 1.005076016230922, 1.0062373233787927, 1.0071983695282356, 1.0079785457181314, 1.0085841909715616, 1.0090651371838022, 1.0094507555452557];

v8 = [1.0000000000000624, 1.0019318704464109, 1.0035400088834203, 1.004880037475142, 1.005995874850676, 1.00691894063693, 1.007667880137, 1.0082488194217019, 1.0087100369615642, 1.0090793611359203];

v9 = [1.0000000000000624, 1.0018605094754685, 1.003408927585228, 1.0046989107519984, 1.0057728103240786, 1.0066609049112338, 1.007381148086875, 1.0079394614216117, 1.0083826711290438, 1.008737210518416];

v10 = [1.0000000000000624, 1.0017943234289786, 1.003287378607936, 1.0045310028191767, 1.0055660951070142, 1.0064218762561687, 1.0071156564391732, 1.007653161199571, 1.0080798571582392, 1.0084209083428994];

writeToCSV(Displacement', v0', 'penalty_k1_0.csv');
writeToCSV(Displacement', v1', 'penalty_k1_1.csv');
writeToCSV(Displacement', v2', 'penalty_k1_2.csv');
writeToCSV(Displacement', v3', 'penalty_k1_3.csv');
writeToCSV(Displacement', v4', 'penalty_k1_4.csv');
writeToCSV(Displacement', v5', 'penalty_k1_5.csv');
writeToCSV(Displacement', v6', 'penalty_k1_6.csv');
writeToCSV(Displacement', v7', 'penalty_k1_7.csv');
writeToCSV(Displacement', v8', 'penalty_k1_8.csv');
writeToCSV(Displacement', v9', 'penalty_k1_9.csv');
writeToCSV(Displacement', v10', 'penalty_k1_10.csv');


% plot(Displacement,(v0-1)*100) % percent volume change with respect to initial volume
% hold on
% plot(Displacement,(v1-1)*100)
% plot(Displacement,(v2-1)*100)
% plot(Displacement,(v3-1)*100)
% plot(Displacement,(v4-1)*100)
% plot(Displacement,(v5-1)*100)
% plot(Displacement,(v6-1)*100)
% plot(Displacement,(v7-1)*100)
% plot(Displacement,(v8-1)*100)
% plot(Displacement,(v9-1)*100)
% plot(Displacement,(v10-1)*100)
% 
% legend("e1 = 0", "e1 = 1", "e1 = 2", "e1 = 3", "e1 = 4", "e1 = 5", "e1 = 6", "e1 = 7", "e1 = 8", "e1 = 9", "e1 = 10");
% 
% xlabel("Displacement")
% ylabel("percent volume change with respect to initial volume")

function writeToCSV(x, y, filename)
data = [x, y];
table = array2table(data, 'VariableNames', {'x', 'y'});
writetable(table, filename, 'Delimiter', ' ');
end